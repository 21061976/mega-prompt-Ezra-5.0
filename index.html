<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>×“×•×— × ×™×”×•×œ ×¡×™×›×•× ×™× - {{PROJECT_NAME}}</title>
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
line-height: 1.6;
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
color: #2c3e50;
}

.container {
max-width: 1200px;
margin: 0 auto;
background: rgba(255, 255, 255, 0.98);
border-radius: 20px;
box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
overflow: hidden;
}

.header {
background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
color: white;
padding: 50px 40px;
text-align: center;
position: relative;
overflow: hidden;
}

.header::before {
content: '';
position: absolute;
top: 0;
left: 0;
right: 0;
bottom: 0;
background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
opacity: 0.3;
}

.header h1 {
font-size: 3em;
margin-bottom: 15px;
position: relative;
z-index: 1;
text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
}

.header .subtitle {
font-size: 1.4em;
opacity: 0.9;
position: relative;
z-index: 1;
margin-bottom: 10px;
}

.date-badge {
display: inline-block;
background: rgba(255,255,255,0.2);
padding: 8px 16px;
border-radius: 20px;
font-size: 0.9em;
margin-top: 15px;
backdrop-filter: blur(10px);
position: relative;
z-index: 1;
}

.edit-toggle {
position: fixed;
top: 20px;
left: 20px;
background: #3498db;
color: white;
border: none;
padding: 15px 25px;
border-radius: 25px;
cursor: pointer;
font-size: 1em;
font-weight: bold;
box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
z-index: 1000;
transition: all 0.3s ease;
}

.edit-toggle:hover {
background: #2980b9;
transform: translateY(-2px);
}

.edit-toggle.active {
background: #27ae60;
}

.pdf-export {
position: fixed;
top: 80px;
left: 20px;
background: #e74c3c;
color: white;
border: none;
padding: 15px 25px;
border-radius: 25px;
cursor: pointer;
font-size: 1em;
font-weight: bold;
box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
z-index: 1000;
transition: all 0.3s ease;
}

.html-export {
position: fixed;
top: 140px;
left: 20px;
background: #9b59b6;
color: white;
border: none;
padding: 15px 25px;
border-radius: 25px;
cursor: pointer;
font-size: 1em;
font-weight: bold;
box-shadow: 0 4px 15px rgba(155, 89, 182, 0.4);
z-index: 1000;
transition: all 0.3s ease;
}

.html-export:hover {
background: #8e44ad;
transform: translateY(-2px);
}

.pdf-export:hover {
background: #c0392b;
transform: translateY(-2px);
}

.pdf-export.exporting {
background: #f39c12;
cursor: not-allowed;
}

.editable {
padding: 3px;
border-radius: 3px;
transition: all 0.3s ease;
}

.editable[contenteditable="true"] {
background: rgba(52, 152, 219, 0.1);
border: 2px dashed #3498db;
outline: none;
cursor: text;
padding: 5px;
}

.editable[contenteditable="true"]:hover {
background: rgba(52, 152, 219, 0.2);
}

.editable[contenteditable="true"]:focus {
background: rgba(52, 152, 219, 0.15);
box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
}

.success-message {
position: fixed;
top: 100px;
right: 20px;
background: #27ae60;
color: white;
padding: 15px 25px;
border-radius: 10px;
font-weight: bold;
opacity: 0;
transform: translateX(400px);
transition: all 0.3s ease;
z-index: 1001;
}

.success-message.show {
opacity: 1;
transform: translateX(0);
}

.nav-menu {
position: sticky;
top: 0;
background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
z-index: 1000;
box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.nav-links {
display: flex;
justify-content: center;
align-items: center;
padding: 0;
list-style: none;
margin: 0;
}

.nav-links li {
flex: 1;
}

.nav-links a {
display: block;
padding: 18px 20px;
color: #bdc3c7;
text-decoration: none;
text-align: center;
font-weight: 600;
font-size: 0.95em;
transition: all 0.3s ease;
border-left: 1px solid #2c3e50;
position: relative;
}

.nav-links li:first-child a {
border-left: none;
}

.nav-links a:hover,
.nav-links a.active {
background: #2c3e50;
color: white;
transform: translateY(-2px);
}

.nav-links a::after {
content: '';
position: absolute;
bottom: 0;
left: 50%;
width: 0;
height: 3px;
background: #3498db;
transition: all 0.3s ease;
transform: translateX(-50%);
}

.nav-links a:hover::after,
.nav-links a.active::after {
width: 80%;
}

.section {
scroll-margin-top: 80px;
}

.section-header {
background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
color: white;
padding: 25px 40px;
font-size: 2.2em;
font-weight: bold;
text-align: center;
margin: 0;
position: relative;
}

.section-header::after {
content: '';
position: absolute;
bottom: -15px;
left: 50%;
transform: translateX(-50%);
width: 80px;
height: 5px;
background: rgba(255, 255, 255, 0.8);
border-radius: 3px;
}

.project-overview {
padding: 40px;
background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
}

.overview-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
gap: 25px;
margin-top: 30px;
}

.overview-card {
background: white;
padding: 25px;
border-radius: 15px;
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
border-top: 4px solid #3498db;
transition: all 0.3s ease;
}

.overview-card:hover {
transform: translateY(-3px);
box-shadow: 0 12px 35px rgba(0, 0, 0, 0.12);
}

.overview-card h4 {
color: #2c3e50;
margin-bottom: 12px;
font-size: 1.2em;
display: flex;
align-items: center;
gap: 10px;
}

.overview-card .icon {
font-size: 1.5em;
}

.goals-section {
background: white;
margin: 30px 40px;
padding: 30px;
border-radius: 15px;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
}

.goals-section h3 {
color: #2c3e50;
margin-bottom: 20px;
font-size: 1.5em;
text-align: center;
}

.goal-item, .deliverable-item {
background: #f8f9fa;
margin: 15px 0;
padding: 20px;
border-radius: 10px;
border-right: 4px solid #27ae60;
transition: all 0.3s ease;
}

.goal-item:hover, .deliverable-item:hover {
background: #e9ecef;
transform: translateX(-5px);
}

.risks-container {
padding: 40px;
background: white;
}

.risk-summary {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
gap: 20px;
margin-bottom: 40px;
}

.summary-card {
background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
padding: 25px;
border-radius: 15px;
text-align: center;
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
transition: transform 0.3s ease;
}

.summary-card:hover {
transform: translateY(-3px);
}

.summary-number {
font-size: 3em;
font-weight: bold;
margin-bottom: 10px;
}

.very-high { color: #e74c3c; }
.high { color: #f39c12; }
.medium { color: #f1c40f; }
.low { color: #27ae60; }

.risks-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
gap: 25px;
margin-top: 30px;
}

.risk-card {
background: white;
border-radius: 15px;
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
padding: 30px;
transition: all 0.3s ease;
border-top: 6px solid;
position: relative;
overflow: hidden;
}

.risk-card::before {
content: '';
position: absolute;
top: 0;
left: 0;
right: 0;
height: 6px;
background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.3) 50%, transparent 100%);
animation: shimmer 2s infinite;
}

@keyframes shimmer {
0% { transform: translateX(-100%); }
100% { transform: translateX(100%); }
}

.risk-card:hover {
transform: translateY(-5px);
box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
}

.risk-very-high { border-top-color: #e74c3c; }
.risk-high { border-top-color: #f39c12; }
.risk-medium { border-top-color: #f1c40f; }
.risk-low { border-top-color: #27ae60; }

.risk-header {
display: flex;
justify-content: space-between;
align-items: flex-start;
margin-bottom: 20px;
gap: 15px;
}

.risk-title {
font-size: 1.3em;
font-weight: bold;
color: #2c3e50;
flex: 1;
}

.risk-severity {
padding: 8px 15px;
border-radius: 25px;
font-size: 0.8em;
font-weight: bold;
color: white;
white-space: nowrap;
}

.severity-very-high { background: #e74c3c; }
.severity-high { background: #f39c12; }
.severity-medium { background: #f1c40f; color: #2c3e50; }
.severity-low { background: #27ae60; }

.risk-metrics {
display: grid;
grid-template-columns: 1fr 1fr 1fr;
gap: 15px;
margin: 20px 0;
text-align: center;
}

.metric {
background: #f8f9fa;
padding: 15px;
border-radius: 10px;
}

.metric-value {
font-size: 1.8em;
font-weight: bold;
color: #2c3e50;
}

.metric-label {
font-size: 0.9em;
color: #7f8c8d;
margin-top: 5px;
}

.risk-description, .risk-opportunity {
color: #34495e;
line-height: 1.7;
background: #f8f9fa;
padding: 20px;
border-radius: 10px;
margin-top: 15px;
border-right: 4px solid #bdc3c7;
}

.risk-opportunity {
border-right-color: #27ae60;
margin-top: 10px;
}

.risk-impact {
margin-top: 20px;
}

.impact-title {
font-weight: bold;
color: #e74c3c;
margin-bottom: 10px;
}

.impact-list {
list-style: none;
padding-right: 15px;
}

.impact-list li {
padding: 8px 0;
border-bottom: 1px solid #ecf0f1;
position: relative;
}

.impact-list li::before {
content: 'âš ï¸';
margin-left: 10px;
}

.opportunity-title {
font-weight: bold;
color: #27ae60;
margin-top: 20px;
margin-bottom: 10px;
}

.opportunity-list {
list-style: none;
padding-right: 15px;
}

.opportunity-list li {
padding: 8px 0;
border-bottom: 1px solid #ecf0f1;
position: relative;
}

.opportunity-list li::before {
content: 'âœ…';
margin-left: 10px;
}

.strategies-section {
padding: 50px 40px;
background: linear-gradient(135deg, #ecf0f1 0%, #bdc3c7 100%);
}

.strategy-card {
background: white;
margin: 30px 0;
border-radius: 20px;
box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
overflow: hidden;
transition: all 0.3s ease;
}

.strategy-card:hover {
transform: translateY(-5px);
box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
}

.strategy-header {
background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
color: white;
padding: 25px 30px;
font-weight: bold;
font-size: 1.3em;
position: relative;
}

.strategy-header::after {
content: '';
position: absolute;
bottom: -10px;
left: 30px;
width: 40px;
height: 4px;
background: rgba(255, 255, 255, 0.8);
border-radius: 2px;
}

.strategy-content {
padding: 30px;
}

.strategy-detail {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
gap: 20px;
margin-top: 20px;
}

.detail-item {
background: #f8f9fa;
padding: 20px;
border-radius: 12px;
border-right: 4px solid #27ae60;
transition: all 0.3s ease;
}

.detail-item:hover {
background: #e9ecef;
transform: translateX(-3px);
}

.detail-item h5 {
color: #27ae60;
margin-bottom: 8px;
font-size: 1.1em;
}

.timeline-badge {
display: inline-block;
background: #3498db;
color: white;
padding: 5px 12px;
border-radius: 15px;
font-size: 0.8em;
margin-top: 10px;
}

.summary-box {
background: white;
padding: 30px;
border-radius: 15px;
margin: 30px 0;
box-shadow: 0 8px 25px rgba(0,0,0,0.08);
}

.committee-recommendations {
background: #f0f8ff;
padding: 25px;
border-radius: 15px;
margin-top: 30px;
border-left: 6px solid #3498db;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
}

.committee-recommendations h4 {
color: #34495e;
font-size: 1.4em;
margin-bottom: 15px;
display: flex;
align-items: center;
gap: 10px;
}

.innovation-section {
background: linear-gradient(135deg, #8e44ad 0%, #9b59b6 100%);
color: white;
padding: 50px 40px;
text-align: center;
position: relative;
}

.innovation-score {
font-size: 5em;
font-weight: bold;
margin: 30px 0;
text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
position: relative;
}

.innovation-components {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
gap: 25px;
margin-top: 40px;
}

.component-card {
background: rgba(255, 255, 255, 0.15);
padding: 25px;
border-radius: 15px;
backdrop-filter: blur(15px);
border: 1px solid rgba(255, 255, 255, 0.2);
transition: all 0.3s ease;
}

.component-card:hover {
background: rgba(255, 255, 255, 0.2);
transform: translateY(-3px);
}

.component-score {
font-size: 2.5em;
font-weight: bold;
color: #f39c12;
margin-bottom: 10px;
}

.component-title {
font-size: 1.1em;
font-weight: bold;
margin-bottom: 10px;
}

.regulation-section {
padding: 40px;
background: #ecf0f1;
}

.regulation-table {
width: 100%;
background: white;
border-radius: 15px;
overflow: hidden;
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
margin: 20px 0;
}

.regulation-table th,
.regulation-table td {
padding: 20px;
text-align: right;
border-bottom: 1px solid #ecf0f1;
vertical-align: top;
}

.regulation-table th {
background: #34495e;
color: white;
font-weight: bold;
}

.regulation-table tr:hover {
background: #f8f9fa;
}

.footer {
background: #2c3e50;
color: white;
text-align: center;
padding: 30px;
font-size: 0.9em;
}

.back-to-top {
position: fixed;
bottom: 30px;
left: 30px;
background: #3498db;
color: white;
width: 50px;
height: 50px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
transition: all 0.3s ease;
z-index: 1000;
opacity: 0;
transform: translateY(20px);
}

.back-to-top.visible {
opacity: 1;
transform: translateY(0);
}

.back-to-top:hover {
background: #2980b9;
transform: translateY(-3px);
box-shadow: 0 6px 20px rgba(52, 152, 219, 0.6);
}

@media (max-width: 768px) {
.header h1 {
font-size: 2.2em;
}

.nav-links {
flex-direction: column;
}

.nav-links a {
border-left: none;
border-bottom: 1px solid #2c3e50;
}

.nav-links li:last-child a {
border-bottom: none;
}

.risks-grid,
.overview-grid,
.innovation-components {
grid-template-columns: 1fr;
}

.innovation-score {
font-size: 3.5em;
}

.risk-header {
flex-direction: column;
align-items: flex-start;
}

.risk-metrics {
grid-template-columns: 1fr;
}

.back-to-top {
bottom: 20px;
left: 20px;
width: 45px;
height: 45px;
}

.edit-toggle {
top: 10px;
left: 10px;
padding: 12px 20px;
font-size: 0.9em;
}
.pdf-export {
top: 65px;
left: 10px;
padding: 12px 20px;
font-size: 0.9em;
}
.html-export {
top: 120px;
left: 10px;
padding: 12px 20px;
font-size: 0.9em;
}
}

html {
scroll-behavior: smooth;
}

/* CSS ××©×•×¤×¨ ×œ×”×“×¤×¡×” - ×¦××¦×•× ×¨×•×•×—×™× */
@media print {
    * {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        color-adjust: exact !important;
    }
    
    html, body {
        margin: 0 !important;
        padding: 0 !important;
        background: white !important;
        font-size: 9pt !important;
        line-height: 1.2 !important;
    }
    
    .container {
        max-width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        box-shadow: none !important;
        border-radius: 0 !important;
    }
    
    .edit-toggle, .pdf-export, .html-export, .back-to-top, .nav-menu {
        display: none !important;
    }
    
    /* ×›×•×ª×¨×ª ×¨××©×™×ª */
    .header {
        padding: 10px 10px !important;
        margin: 0 !important;
        page-break-after: avoid !important;
    }
    
    .header h1 {
        font-size: 20pt !important;
        margin-bottom: 5px !important;
    }
    
    .header .subtitle {
        font-size: 10pt !important;
        margin-bottom: 3px !important;
    }
    
    .date-badge {
        padding: 3px 8px !important;
        margin-top: 5px !important;
        font-size: 8pt !important;
    }
    
    /* ×›×•×ª×¨×•×ª ×¡×§×¦×™×•×ª */
    .section-header {
        padding: 8px 10px !important;
        font-size: 12pt !important;
        margin: 0 !important;
        page-break-after: avoid !important;
    }
    
    .section-header::after {
        display: none !important;
    }
    
    /* ×¡×§×¦×™×•×ª */
    .section {
        margin: 0 !important;
        padding: 0 !important;
    }
    
    .project-overview {
        padding: 8px 10px !important;
    }
    
    /* ×›×¨×˜×™×¡×™ ×¡×§×™×¨×” */
    .overview-grid {
        grid-template-columns: repeat(3, 1fr) !important;
        gap: 5px !important;
        margin-top: 8px !important;
    }
    
    .overview-card {
        padding: 6px 8px !important;
        border-radius: 5px !important;
        page-break-inside: avoid !important;
    }
    
    .overview-card h4 {
        font-size: 9pt !important;
        margin-bottom: 3px !important;
    }
    
    .overview-card p {
        font-size: 8pt !important;
        margin: 0 !important;
    }
    
    /* ××˜×¨×•×ª ×•×ª×•×¦×¨×™× */
    .goals-section {
        margin: 5px 10px !important;
        padding: 8px !important;
        page-break-inside: avoid !important;
    }
    
    .goals-section h3 {
        font-size: 11pt !important;
        margin-bottom: 8px !important;
    }
    
    .goal-item, .deliverable-item {
        margin: 5px 0 !important;
        padding: 5px 8px !important;
        font-size: 8pt !important;
        border-radius: 3px !important;
    }
    
    /* ××™×›×œ ×¡×™×›×•× ×™× */
    .risks-container {
        padding: 8px 10px !important;
    }
    
    /* ×¡×™×›×•× ×¡×™×›×•× ×™× */
    .risk-summary {
        gap: 8px !important;
        margin-bottom: 10px !important;
    }
    
    .summary-card {
        padding: 8px !important;
        border-radius: 5px !important;
    }
    
    .summary-number {
        font-size: 16pt !important;
        margin-bottom: 3px !important;
    }
    
    .summary-card div:last-child {
        font-size: 7pt !important;
    }
    
    /* ×›×¨×˜×™×¡×™ ×¡×™×›×•×Ÿ */
    .risks-grid {
        grid-template-columns: 1fr !important;
        gap: 8px !important;
        margin-top: 10px !important;
    }
    
    .risk-card {
        padding: 10px !important;
        margin: 0 0 8px 0 !important;
        page-break-inside: avoid !important;
        border-radius: 5px !important;
        border-top-width: 4px !important;
    }
    
    .risk-card::before {
        display: none !important;
    }
    
    .risk-header {
        margin-bottom: 8px !important;
        gap: 8px !important;
    }
    
    .risk-title {
        font-size: 10pt !important;
    }
    
    .risk-severity {
        padding: 3px 8px !important;
        font-size: 7pt !important;
        border-radius: 12px !important;
    }
    
    /* ××˜×¨×™×§×•×ª ×¡×™×›×•×Ÿ */
    .risk-metrics {
        grid-template-columns: repeat(3, 1fr) !important;
        gap: 5px !important;
        margin: 8px 0 !important;
    }
    
    .metric {
        padding: 5px !important;
        border-radius: 3px !important;
    }
    
    .metric-value {
        font-size: 12pt !important;
    }
    
    .metric-label {
        font-size: 7pt !important;
        margin-top: 2px !important;
    }
    
    /* ×ª×™××•×¨×™ ×¡×™×›×•×Ÿ */
    .risk-description, .risk-opportunity {
        font-size: 8pt !important;
        padding: 5px 8px !important;
        margin-top: 5px !important;
        border-radius: 3px !important;
        line-height: 1.3 !important;
    }
    
    /* ×¨×©×™××•×ª ×”×©×¤×¢×” ×•×”×–×“×× ×•×™×•×ª */
    .impact-title, .opportunity-title {
        font-size: 9pt !important;
        margin-top: 8px !important;
        margin-bottom: 5px !important;
    }
    
    .impact-list, .opportunity-list {
        padding-right: 10px !important;
    }
    
    .impact-list li, .opportunity-list li {
        font-size: 8pt !important;
        padding: 3px 0 !important;
    }
    
    /* ××¡×˜×¨×˜×’×™×•×ª */
    .strategies-section {
        padding: 10px !important;
    }
    
    .strategy-card {
        margin: 8px 0 !important;
        page-break-inside: avoid !important;
        border-radius: 5px !important;
    }
    
    .strategy-header {
        padding: 8px 10px !important;
        font-size: 10pt !important;
    }
    
    .strategy-header::after {
        display: none !important;
    }
    
    .strategy-content {
        padding: 8px 10px !important;
    }
    
    .strategy-detail {
        gap: 5px !important;
        margin-top: 8px !important;
    }
    
    .detail-item {
        padding: 5px 8px !important;
        border-radius: 3px !important;
    }
    
    .detail-item h5 {
        font-size: 9pt !important;
        margin-bottom: 3px !important;
    }
    
    .detail-item p {
        font-size: 8pt !important;
        margin: 0 !important;
    }
    
    .timeline-badge {
        padding: 2px 6px !important;
        font-size: 7pt !important;
        margin-top: 3px !important;
    }
    
    /* ×¡×™×›×•××™× */
    .summary-box {
        padding: 10px !important;
        margin: 8px 0 !important;
        border-radius: 5px !important;
        page-break-inside: avoid !important;
    }
    
    .summary-box h3 {
        font-size: 11pt !important;
        margin-bottom: 8px !important;
    }
    
    .summary-box p {
        font-size: 8pt !important;
        line-height: 1.3 !important;
    }
    
    /* ×”××œ×¦×•×ª ×•×¢×“×” */
    .committee-recommendations {
        padding: 8px !important;
        margin-top: 8px !important;
        border-left-width: 4px !important;
        border-radius: 3px !important;
    }
    
    .committee-recommendations h4 {
        font-size: 10pt !important;
        margin-bottom: 5px !important;
    }
    
    .committee-recommendations p {
        font-size: 8pt !important;
    }
    
    /* ×—×“×©× ×•×ª */
    .innovation-section {
        padding: 10px !important;
        page-break-inside: avoid !important;
    }
    
    .innovation-score {
        font-size: 24pt !important;
        margin: 10px 0 !important;
    }
    
    .innovation-components {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 5px !important;
        margin-top: 10px !important;
    }
    
    .component-card {
        padding: 8px !important;
        border-radius: 5px !important;
    }
    
    .component-score {
        font-size: 14pt !important;
        margin-bottom: 3px !important;
    }
    
    .component-title {
        font-size: 9pt !important;
        margin-bottom: 3px !important;
    }
    
    .component-card p {
        font-size: 8pt !important;
        margin: 0 !important;
    }
    
    /* ×˜×‘×œ×ª ×¨×’×•×œ×¦×™×” */
    .regulation-section {
        padding: 8px 10px !important;
    }
    
    .regulation-section > p {
        font-size: 9pt !important;
        margin-bottom: 8px !important;
    }
    
    .regulation-table {
        font-size: 8pt !important;
        margin: 8px 0 !important;
        border-radius: 5px !important;
    }
    
    .regulation-table th, .regulation-table td {
        padding: 5px 8px !important;
        border-bottom-width: 1px !important;
    }
    
    .regulation-table th {
        font-size: 9pt !important;
    }
    
    /* ×›×•×ª×¨×ª ×ª×—×ª×•× ×” */
    .footer {
        padding: 10px !important;
        font-size: 8pt !important;
        margin-top: 10px !important;
    }
    
    .footer div {
        margin-top: 8px !important;
        padding-top: 8px !important;
        font-size: 7pt !important;
    }
    
    /* ×›×œ×œ×™ */
    h1, h2, h3, h4, h5, h6 {
        margin-top: 0 !important;
        margin-bottom: 5px !important;
        page-break-after: avoid !important;
    }
    
    p {
        margin: 0 0 5px 0 !important;
    }
    
    ul, ol {
        margin: 0 !important;
        padding-right: 15px !important;
    }
    
    li {
        margin: 0 !important;
        padding: 2px 0 !important;
    }
    
    /* ×”×’×“×¨×•×ª ×¢××•×“ */
    @page {
        margin: 10mm;
        size: A4;
    }
    
    /* ××•× ×¢ ×©×‘×™×¨×ª ×“×¤×™× ×‘×××¦×¢ ××œ×× ×˜×™× */
    .risk-card, .strategy-card, .overview-card, .summary-box, 
    .goals-section, .committee-recommendations, .component-card {
        page-break-inside: avoid !important;
    }
    
    /* ×¨×•×•×— ×‘×™×Ÿ ×¡×§×¦×™×•×ª */
    .section + .section {
        margin-top: 10px !important;
    }
}
</style>
</head>
<body>
<div class="container">
<button class="edit-toggle" id="editToggle">ğŸ¨ ×”×ª×—×œ ×¢×¨×™×›×”</button>
<button class="pdf-export" id="pdfExport">ğŸ“„ ×™×™×¦×•× ×œ-PDF</button>
<button class="html-export" id="htmlExport">ğŸ’¾ ×©××•×¨ ×›-HTML</button>

<div class="success-message" id="successMessage">âœ… ××¦×‘ ×¢×¨×™×›×” ×”×•×¤×¢×œ!</div>

<header class="header">
<h1 class="editable">×“×•×— × ×™×”×•×œ ×¡×™×›×•× ×™× ××§×™×£</h1>
<div class="subtitle editable">{{PROJECT_NAME}} - {{PROJECT_DESCRIPTION}}</div>
<div class="date-badge editable">{{ORGANIZATION}} â€¢ 2025</div>
</header>

<nav class="nav-menu">
<ul class="nav-links">
<li><a href="#project" class="nav-link">ğŸ“‹ ×”×’×“×¨×ª ×”×¤×¨×•×™×§×˜</a></li>
<li><a href="#risks" class="nav-link">âš ï¸ × ×™×”×•×œ ×¡×™×›×•× ×™×</a></li>
<li><a href="#strategies" class="nav-link">ğŸ“ˆ ×ª×•×›× ×™×ª ×”×ª××•×“×“×•×ª</a></li>
<li><a href="#innovation" class="nav-link">ğŸš€ ××¡×“×¨×ª ×—×“×©× ×•×ª</a></li>
<li><a href="#innovation-level" class="nav-link">ğŸ“Š ×¨××ª ×”×—×“×©× ×•×ª</a></li>
<li><a href="#regulation-compliance" class="nav-link">âœ… ×”×ª×××” ×œ×“×¨×™×©×•×ª ××¡×“×¨×”</a></li>
<li><a href="#executive-summary-section" class="nav-link">ğŸ“ ×¡×™×›×•× ×× ×”×œ×™× ×•×”××œ×¦×•×ª</a></li>
</ul>
</nav>

<section id="project" class="section">
<div class="section-header editable">ğŸ“‹ ×”×’×“×¨×ª ×”×¤×¨×•×™×§×˜</div>

<div class="project-overview">
<h2 style="text-align: center; color: #2c3e50; font-size: 2.2em; margin-bottom: 30px;" class="editable">×¤×¨×˜×™ ×”×¤×¨×•×™×§×˜</h2>
<div class="overview-grid">
<div class="overview-card">
<h4><span class="icon">ğŸ‘¤</span><span class="editable">×× ×”×œ ×”×¤×¨×•×™×§×˜</span></h4>
<p class="editable">{{PROJECT_MANAGER}}</p>
</div>
<div class="overview-card">
<h4><span class="icon">ğŸ¢</span><span class="editable">××¨×’×•×Ÿ</span></h4>
<p class="editable">{{ORGANIZATION}}</p>
</div>
<div class="overview-card">
<h4><span class="icon">ğŸŒ</span><span class="editable">×”×™×§×£ ×”×¤×¨×•×™×§×˜</span></h4>
<p class="editable">{{PROJECT_SCOPE}}</p>
</div>
<div class="overview-card">
<h4><span class="icon">ğŸ“…</span><span class="editable">×œ×•×— ×–×× ×™×</span></h4>
<p class="editable">{{TIMELINE}}</p>
</div>
<div class="overview-card">
<h4><span class="icon">ğŸš€</span><span class="editable">×¡×•×’ ×”×¤×¨×•×™×§×˜</span></h4>
<p class="editable">{{PROJECT_TYPE}}</p>
</div>
<div class="overview-card">
<h4><span class="icon">ğŸ¤</span><span class="editable">×©×•×ª×¤×™× ×¨×’×•×œ×˜×•×¨×™×</span></h4>
<p class="editable">{{REGULATORY_PARTNERS}}</p>
</div>
</div>
</div>

<div class="goals-section">
<h3 class="editable">ğŸ¯ ××˜×¨×•×ª ×”×¤×¨×•×™×§×˜ (×¢×“ 3 ××˜×¨×•×ª ××¨×›×–×™×•×ª)</h3>
{{GOALS_LIST}}
</div>

<div class="goals-section">
<h3 class="editable">ğŸ“‹ ×ª×•×¦×¨×™× ××¦×•×¤×™×</h3>
{{DELIVERABLES_LIST}}
</div>
</section>

<section id="risks" class="section">
<div class="section-header editable">âš ï¸ × ×™×”×•×œ ×¡×™×›×•× ×™×</div>

<div class="risks-container">
<div class="risk-summary">
<div class="summary-card">
<div class="summary-number very-high editable">{{RISK_COUNT_VERY_HIGH}}</div>
<div class="editable">×¡×™×›×•× ×™× ×‘×—×•××¨×”<br>×’×‘×•×”×” ×××•×“</div>
</div>
<div class="summary-card">
<div class="summary-number high editable">{{RISK_COUNT_HIGH}}</div>
<div class="editable">×¡×™×›×•× ×™× ×‘×—×•××¨×”<br>×’×‘×•×”×”</div>
</div>
<div class="summary-card">
<div class="summary-number medium editable">{{RISK_COUNT_MEDIUM}}</div>
<div class="editable">×¡×™×›×•× ×™× ×‘×—×•××¨×”<br>×‘×™× ×•× ×™×ª</div>
</div>
<div class="summary-card">
<div class="summary-number low editable">{{RISK_COUNT_LOW}}</div>
<div class="editable">×¡×™×›×•× ×™× ×‘×—×•××¨×”<br>× ××•×›×”</div>
</div>
</div>

<div class="risks-grid">
<!-- ×“×•×’××” ×œ×›×¨×˜×™×¡ ×¡×™×›×•×Ÿ ×¢× ×§×™×©×•×¨ ×œ××˜×¨×”:
<div class="risk-card risk-high">
    <div class="risk-header">
        <h3 class="risk-title editable">×›×•×ª×¨×ª ×”×¡×™×›×•×Ÿ</h3>
        <span class="risk-severity severity-high editable">×’×‘×•×”</span>
    </div>
    <div style="font-size: 0.9em; color: #3498db; margin-bottom: 10px;" class="editable">
        <strong>(× ×’×–×¨ ×××˜×¨×” 1: ×©× ×”××˜×¨×”)</strong>
    </div>
    <div class="risk-metrics">...</div>
    ...
</div>
-->
{{RISKS_CARDS}}
</div>
</div>
</section>

<section id="strategies" class="section">
<div class="section-header editable">ğŸ“ˆ ×ª×•×›× ×™×ª ×”×ª××•×“×“×•×ª ×¢× ×¡×™×›×•× ×™×</div>
<div class="strategies-section">
{{STRATEGIES_CARDS}}
</div>
</section>

<section id="innovation" class="section">
<div class="section-header editable">ğŸš€ ××¡×“×¨×ª ×—×“×©× ×•×ª</div>
<div class="risks-container">
<p class="editable" style="text-align: center; font-size: 1.1em; margin-bottom: 25px;">
{{INNOVATION_DESCRIPTION}}
</p>
<div class="summary-box">
<h3 style="text-align: center; color: #2c3e50; font-size: 1.8em; margin-bottom: 20px;" class="editable">×”×’×“×¨×ª ×¨××ª ×”×—×“×©× ×•×ª</h3>
<p class="editable">{{INNOVATION_DEFINITION}}</p>
<div class="committee-recommendations">
<h4><span class="icon">ğŸ‘¥</span><span class="editable">×”×ª×™×™×—×¡×•×ª ×œ×—×“×©× ×•×ª ××—×¨××™×ª:</span></h4>
<p class="editable">{{RESPONSIBLE_INNOVATION_STATEMENT}}</p>
</div>
</div>
</div>
</section>

<section id="innovation-level" class="section innovation-section">
<div class="section-header editable">ğŸ“Š ×¨××ª ×”×—×“×©× ×•×ª ×‘×¤×¨×•×™×§×˜</div>
<p class="editable" style="font-size: 1.2em; max-width: 800px; margin: 20px auto 40px; color: rgba(255,255,255,0.9);">
{{INNOVATION_CRITERIA_DESCRIPTION}}
</p>
<div class="innovation-score editable">{{INNOVATION_SCORE}} / 10</div>
<div class="innovation-components">
{{INNOVATION_COMPONENTS}}
</div>
</section>

<section id="regulation-compliance" class="section">
<div class="section-header editable">âœ… ×”×ª×××” ×œ×“×¨×™×©×•×ª ××¡×“×¨×”</div>
<div class="regulation-section">
<p class="editable" style="font-size: 1.1em; text-align: center; margin-bottom: 30px;">
{{REGULATION_INTRO}}
</p>
<div class="regulation-table">
<table>
<thead>
<tr>
<th class="editable">×“×¨×™×©×ª ××¡×“×¨×”</th>
<th class="editable">×ª×™××•×¨</th>
<th class="editable">×¡×˜×˜×•×¡ ×”×ª×××”</th>
<th class="editable">×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª</th>
</tr>
</thead>
<tbody>
{{REGULATION_TABLE_ROWS}}
</tbody>
</table>
</div>
</div>
</section>

<section id="executive-summary-section" class="section">
<div class="section-header editable">ğŸ“ ×¡×™×›×•× ×× ×”×œ×™× ×•×”××œ×¦×•×ª</div>
<div class="risks-container">
<div class="summary-box" style="margin-bottom: 40px;">
<h3 style="text-align: center; color: #2c3e50; font-size: 1.8em; margin-bottom: 20px;" class="editable">×¡×™×›×•× ×× ×”×œ×™×: {{PROJECT_NAME}} ×‘××‘×˜ ×¢×œ</h3>
<p class="editable">{{EXECUTIVE_SUMMARY}}</p>
</div>

<div class="summary-box">
<h3 style="text-align: center; color: #2c3e50; font-size: 1.8em; margin-bottom: 20px;" class="editable">×”××œ×¦×•×ª ××¨×›×–×™×•×ª:</h3>
{{RECOMMENDATIONS_LIST}}
</div>
</div>
</section>

<footer class="footer">
<p class="editable">Â© 2025 {{ORGANIZATION}}. ×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª.</p>
<div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #34495e; font-size: 0.8em; opacity: 0.8;">
<p class="editable"><strong>×¤×™×ª×•×— ×•×¢×™×¦×•×‘ ××•×¦×¨:</strong> ×“"×¨ ××¡×£ ××•×–×Ÿ</p>
</div>
</footer>
</div>

<button class="back-to-top" id="backToTop">â¬†ï¸</button>

<script>
// ×”×’×“×¨×ª ××©×ª× ×™× ×’×œ×•×‘×œ×™×™×
const editToggleButton = document.getElementById('editToggle');
const pdfExportButton = document.getElementById('pdfExport');
const htmlExportButton = document.getElementById('htmlExport');
const backToTopButton = document.getElementById('backToTop');
const successMessage = document.getElementById('successMessage');
const editableElements = document.querySelectorAll('.editable');
let isEditing = false;

// ×¤×•× ×§×¦×™×™×ª ×”×—×œ×¤×ª ××¦×‘ ×¢×¨×™×›×”
function toggleEdit() {
    isEditing = !isEditing;
    editableElements.forEach(el => {
        el.contentEditable = isEditing;
    });
    
    if (isEditing) {
        editToggleButton.textContent = 'ğŸ’¾ ×¡×™×™× ×¢×¨×™×›×”';
        editToggleButton.classList.add('active');
        showMessage('âœ… ××¦×‘ ×¢×¨×™×›×” ×”×•×¤×¢×œ!');
    } else {
        editToggleButton.textContent = 'ğŸ¨ ×”×ª×—×œ ×¢×¨×™×›×”';
        editToggleButton.classList.remove('active');
        showMessage('âœ… ×”×©×™× ×•×™×™× × ×©××¨×•!');
    }
}

// ×¤×•× ×§×¦×™×™×ª ×”×¦×’×ª ×”×•×“×¢×•×ª
function showMessage(msg) {
    successMessage.textContent = msg;
    successMessage.classList.add('show');
    setTimeout(() => {
        successMessage.classList.remove('show');
    }, 3000);
}

// ×¤×•× ×§×¦×™×™×ª ×™×™×¦×•× ×œ-PDF
async function exportToPDF() {
    const button = pdfExportButton;
    
    if (button.classList.contains('exporting')) return;
    
    button.classList.add('exporting');
    button.textContent = 'â³ ××™×™×¦×...';
    
    try {
        const wasEditing = isEditing;
        if (wasEditing) {
            editableElements.forEach(el => {
                el.contentEditable = false;
            });
        }
        
        // ×”×¡×ª×¨×ª ××œ×× ×˜×™×
        const elementsToHide = ['.edit-toggle', '.pdf-export', '.html-export', '.success-message', '.back-to-top'];
        elementsToHide.forEach(selector => {
            const el = document.querySelector(selector);
            if (el) el.style.display = 'none';
        });
        
        // ×¤×ª×™×—×ª ×—×œ×•×Ÿ ×”×”×“×¤×¡×”
        setTimeout(() => {
            window.print();
            
            // ×”×—×–×¨×ª ×”××œ×× ×˜×™×
            setTimeout(() => {
                elementsToHide.forEach(selector => {
                    const el = document.querySelector(selector);
                    if (el) el.style.display = '';
                });
                
                if (wasEditing) {
                    editableElements.forEach(el => {
                        el.contentEditable = true;
                    });
                }
                
                button.classList.remove('exporting');
                button.textContent = 'ğŸ“„ ×™×™×¦×•× ×œ-PDF';
                
                showMessage('âœ… ×”×”×“×¤×¡×” ×”×•×©×œ××”! ×‘×—×¨ "×©××•×¨ ×›-PDF" ×‘×“×¤×“×¤×Ÿ');
            }, 1000);
        }, 500);
        
    } catch (error) {
        console.error('Export failed:', error);
        button.classList.remove('exporting');
        button.textContent = 'ğŸ“„ ×™×™×¦×•× ×œ-PDF';
        showMessage('âŒ ×©×’×™××” ×‘×™×™×¦×•×. × ×¡×” ×©×•×‘.');
    }
}

// ×¤×•× ×§×¦×™×™×ª ×©××™×¨×” ×›-HTML
function saveAsHTML() {
    const allEditables = document.querySelectorAll('.editable');
    let savedData = {};
    
    allEditables.forEach((el, index) => {
        savedData['elem_' + index] = el.innerHTML;
    });
    
    const message = `×›×“×™ ×œ×©××•×¨ ××ª ×”×“×•×— ×¢× ×›×œ ×”×©×™× ×•×™×™×:

1. ×œ×—×¥ Ctrl+A (×‘×—×¨ ×”×›×œ)
2. ×œ×—×¥ Ctrl+C (×”×¢×ª×§)
3. ×¤×ª×— Notepad ××• ×¢×•×¨×š ×˜×§×¡×˜
4. ×œ×—×¥ Ctrl+V (×”×“×‘×§)
5. ×©××•×¨ ×›×§×•×‘×¥ .html

×œ×—×œ×•×¤×™×Ÿ:
1. ×œ×—×¥ ×›×¤×ª×•×¨ ×™×× ×™ ×¢×œ ×”×“×£
2. ×‘×—×¨ 'Save as' ××• '×©××•×¨ ×‘×©×'
3. ×‘×—×¨ 'Webpage, Complete'

×”×©×™× ×•×™×™× ×©×‘×™×¦×¢×ª × ×©××¨×• ×‘×“×£!`;
    
    alert(message);
    
    try {
        const currentHTML = document.documentElement.outerHTML;
        const dataStr = 'data:text/html;charset=utf-8,' + encodeURIComponent(currentHTML);
        
        const downloadLink = document.createElement('a');
        downloadLink.setAttribute('href', dataStr);
        downloadLink.setAttribute('download', 'risk_report_' + new Date().getTime() + '.html');
        downloadLink.style.display = 'none';
        
        document.body.appendChild(downloadLink);
        downloadLink.click();
        document.body.removeChild(downloadLink);
        
        showMessage('âœ… ×× ×”×”×•×¨×“×” ×œ× ×”×—×œ×”, ×”×©×ª××© ×‘×”×•×¨××•×ª ×©×‘×—×œ×•×Ÿ');
        
    } catch (e) {
        console.log('Download method failed, use manual save');
    }
}

// ×”×•×¡×¤×ª Event Listeners
editToggleButton.addEventListener('click', toggleEdit);
pdfExportButton.addEventListener('click', exportToPDF);
htmlExportButton.addEventListener('click', saveAsHTML);

// ×˜×™×¤×•×œ ×‘×›×¤×ª×•×¨ ×—×–×¨×” ×œ××¢×œ×”
window.addEventListener('scroll', () => {
    if (window.scrollY > 200) {
        backToTopButton.classList.add('visible');
    } else {
        backToTopButton.classList.remove('visible');
    }
});

backToTopButton.addEventListener('click', () => {
    window.scrollTo({
        top: 0,
        behavior: 'smooth'
    });
});

// ×˜×™×¤×•×œ ×‘×ª×¤×¨×™×˜ ×”× ×™×•×•×˜
const sections = document.querySelectorAll('section[id]');
const navLinks = document.querySelectorAll('.nav-link');

window.addEventListener('scroll', () => {
    let current = '';
    sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.clientHeight;
        if (pageYOffset >= sectionTop - 100) {
            current = section.getAttribute('id');
        }
    });

    navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.href.includes(current)) {
            link.classList.add('active');
        }
    });
});

// ×”×¤×¢×œ×ª ×”××™×¨×•×¢ ×”×¨××©×•× ×™
window.dispatchEvent(new Event('scroll'));
</script>
</body>
</html>
